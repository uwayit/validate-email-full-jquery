// Скрипт може проводити валидацію email та показувати СТАНДАРТИЗОВАНІ помилки
// Делатльна інструкція та можливості https://github.com/uwayit/validate-email-full-jquery
function testEmail(e){$(".testEmailButton").prop("disabled",!0),$(".testEmailButton").addClass("disbtn");let a=$(e).val();if(!(a=initialPreparation(a))||"email"===a||"youremail"===a)return sendError(e,"placeholder"),!1;a=(a=(a=clearPlus(a=cleanWww(a))).replace("yandex.com.ua","yandex.ua")).replace("gmail.com.ua","gmail.com");let i={};i.lastPoint=a.lastIndexOf("."),i.lastAt=a.lastIndexOf("@"),i.domainZone=correctDomainZone(a.slice(i.lastPoint+1)),i.localPart=a.slice(0,i.lastAt),i.domainAll=a.slice(i.lastAt+1),i.domainOnly=a.slice(i.lastAt+1,i.lastPoint),a=sborka(i);let l=!1,t=!1,n=!1,r=!1,o=!1,m=!1,u=!1,s=!1,c=!1,d=!1,g=!1,f=!1,_=!1;return(l=numberTest(i.domainAll))?(sendError(e,"numberTestTest"),!1):(t=isLie(a))?(sendError(e,"isLieTest"),!1):(n=validateEmail(a))?(r=stopAnonimayzer(i.domainAll))?(sendError(e,"stopAnonimayzerTest"),!1):(g=sintaksisValid(i))?(sendError(e,"sintaksisValidTest"),!1):(i.domainOnly=correctName(i.domainOnly),a=sborka(i),d=domainZoneLenght(i.domainZone))?(sendError(e,"domainZoneLenght"),!1):(s=stopDomainALL(a))?(sendError(e,"stopDomainALLTest"),!1):(c=oneLetter(i.domainAll))?(sendError(e,"oneLetterTest"),!1):(f=badZone(i.domainZone))?(sendError(e,"badZoneTest"),!1):(a=buildStandartEmail(a),o=yaPhone(i))?(sendError(e,"yaphoneTest"),!1):(_=minLength(i))?(sendError(e,"minLengthTest"),!1):(m=tireStop(i.domainOnly,i.localPart))?(sendError(e,"tireStopTest"),!1):(u=neNa(i.domainAll))?(sendError(e,"Not on "+u),!1):($(".testEmailButton").prop("disabled",!0),$(".testEmailButton").addClass("disbtn"),$(e).val(a),a):(sendError(e,"regulyarTest"),!1)}function sendError(e,a){return console.log(a),$("."+a).show(),$(e).addClass("errorField"),!0}function sborka(e){return e.localPart+"@"+e.domainOnly+"."+e.domainZone}function initialPreparation(e){return e&&"+"==(e=e.trim().replace(/\s+/g,"").toLowerCase())[0]&&(e=e.substr(1)),e}function cleanWww(e){return e.startsWith("www.")?e.substring(4):e}function clearPlus(e){let a=e.lastIndexOf("+");return a>0?e.substring(0,a)+e.substring(e.indexOf("@")):e}function numberTest(e){return/\d/.test(e)}function isLie(e){let a=e.split("@");if(a[1]==window.location.host||"www."+a[1]==window.location.host)return!0;let i=["mail@mail.ru","gmail@gmail.com","email@mail.ua","email@example.com"];for(let l=0;l<i.length;l++)if(i[l]==e)return!0;return!1}function validateEmail(e){return/^([a-zA-Z0-9._%+-]+)@([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,12}$/.test(e)}function tireStop(e,a){return -1!=e.indexOf("yandex")&&-1!=a.indexOf("_")}function neNa(e){return"my.com"==e?"my.com":"rambler.ua"==e&&"rambler.ua"}function yaPhone(e){return!!(/yandex|ya\.ru/.test(e.domainAll)&&[/^380/,/^37/,/^99/,/^79/,/^89/,/^77/].some(a=>a.test(e.localPart))&&/^\d{11,13}$/.test(e.localPart))}function buildStandartEmail(e){let a=e;if(/@(?:yandex\.[a-z]{2,3}|ya\.ru|narod\.ru)$/i.test(e)){let[i,l]=e.split("@");a=i.replace(/-/g,".")+"@yandex.ru"}if(/@(gmail\.com|googlemail\.com)$/i.test(e)){let[t,n]=e.split("@");a=t.replace(/\./g,"")+"@gmail.com"}if(/@(pm\.me|proton\.me|protonmail\.com)$/i.test(e)){let[r,o]=e.split("@");a=r.replace(/\./g,"")+"@proton.me"}if(/@(icloud\.com)$/i.test(e)){let[m,u]=e.split("@");a=m.replace(/\./g,"")+"@icloud.com"}if(/@(ymail\.com)$/i.test(e)){let[s,c]=e.split("@");a=s+"@yahoo.com"}return a}function stopAnonimayzer(e){let a=["scryptmail.com"];for(let i=0;i<a.length;i++)if(a[i]==e)return!0;return!1}function correctDomainZone(e){let a={ru:["ry","rv","ri","rn","tu","ty","my"],com:["cjm","cpm","kom","gom","vom","con","kon","cm","om","cim","som","xom","cox"],org:["orq","opq","opg"],ua:["ya"],net:["ner","het","bet","nen","nit","met","ney","ne","nwt"]};for(let i in a)if(a[i].includes(e))return i;return e}function correctName(e){let a={yandex:["yandax","yandeks","yandx","yangex","jandex","yadex","uandex","yndex","ayndex"],bigmir:["digmir","biqmir","diqmir"],mail:["mfil","meil","msil","maij","maill","mil","imeil","mael","maii","mali","mal","majl","maul","masl","maik","ail","naul","nail"],icloud:["icloud","cloud","ikloud","iclout","icloub","cloub"],gmail:["gamailcom","gmaill","gmailco","gmel","qm","gmjl","gmm","gmaa","ggmai","cmal","cail","gail","gmal","gmei","gmaij","gmajl","qnail","gnail","gmeil","gmall","jmail","gmaii","gmali","hmail","gmael","jimal","jmeil","qhail","gmoil","ghail","cmail","gamil","dmail","gmaik","gmоil","gimajl","gimail","qemail","gomail","gemeil","gemail","gamail","gameil","gmaul","qeimal","glail","gmaile","goi","qoi","gmfql","gmd"]};for(let i in a)if(a[i].includes(e))return i;return e}function stopDomainALL(e){let a=["com.ua","ua.com","kom.ua","kis.ru","kom.ru","com.ru","ru.com","meil.com","mael.com","emeil.ru","emeil.com","imeil.ua","com.com","net.ua","net.ru","com.net","example.com","sitemail.com","site.com","email.com","mailcom.ru","yahoo.net","hotmail.ru","ramler.ru","ramdler.ru","rambler.com","yaho.com","ua.net","ykr.net","ykt.net","ukt.net","ucr.net","ukr.com","bigmir.ua","bigmir.com","gmail.ru","gmail.ua","gmail.com.ua","gmail.com.ru","ya.ua","ya.com","yande.ru","yande.ua","inboks.ru","indox.ru","list.ua","list.com","iist.ru","iist.ua","bk.com","bk.ua","dk.com","br.com","dk.ru","br.ru","bl.ru","bj.ru","vk.ru","vk.com","vkontakte.ru","mail.com","mail.com.ua","mail.com.ru",],i=["yy","aa"];for(let l=0;l<a.length;l++)if(a[l]==e.domainAll)return!0;for(let t=0;t<i.length;t++)if(e.domainZone==i[t])return!0;return!1}function oneLetter(e){return void 0!=e&&-1==e.indexOf("i.ua")&&-1==e.indexOf("a.ua")&&1==e.split(".")[0].length}function domainZoneLenght(e){return e.length>5}function badZone(e){return"xxx"==e||"biz"==e||"cc"==e}function minLength(e){let a={"i.ua":6,"ro.ru":6,"r0.ru":6,"rambler.ru":6,"lenta.ru":6,"myrambler.ru":6,"gmail.com":5,"mail.ru":3,"mail.ua":3,"inbox.ru":3,"list.ru":3,"bk.ru":3},i=void 0!==a[e.domainAll]?a[e.domainAll]:3;return e.localPart.length<i}function sintaksisValid(e){if(["ya.ru","yandex","mail.ru","bk.ru","mail.ua","inbox.ru","gmail.com","list.ru"].some(a=>e.domainAll.includes(a))&&["..","-.",".-","_.","._","--","-_","_-","__"].some(a=>e.localPart.includes(a))||void 0!=e.localPart[0]&&(-1!=e.localPart[0].indexOf(".")||-1!=e.localPart[0].indexOf("-")||-1!=e.localPart[0].indexOf("_")||-1!=e.localPart[e.localPart.length-1].indexOf(".")||-1!=e.localPart[e.localPart.length-1].indexOf("-")||-1!=e.localPart[e.localPart.length-1].indexOf("_")))return!0;let a=e.domainAll.split(".");if(a.length>3)return!0;let i=a[a.length-1];return!!/\d/.test(i)}$(".email").bind("change keypress keydown keyup",function(){$(this).removeClass("errorField"),$(".errormail").hide(),$(".testEmailButton").prop("disabled",!1),$(".testEmailButton").removeClass("disbtn")});
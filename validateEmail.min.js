$('.email').bind('change keypress keydown keyup',function(){$(this).removeClass('error');$('.errormail').hide();$('.testEmailButton').prop('disabled',!1);$('.testEmailButton').removeClass('disbtn')});function testEmail(emailObj){$('.testEmailButton').prop('disabled',!0);$('.testEmailButton').addClass('disbtn');let email=$(emailObj).val();email=initialPreparation(email);if(!email||email==='email'){$(emailObj).val('');$(emailObj).addClass('error');return!1}
let www=email.split('www.');if(www.length>1){email=www.join('')}
email=email.replace('yandex.com.ua','yandex.ua');email=email.replace('gmail.com.ua','gmail.com');email=clearPlus(email);let epart={};epart.lastPoint=email.lastIndexOf('.');epart.lastAt=email.lastIndexOf('@');epart.domainZone=correctDomainZone(email.slice(epart.lastPoint+1));epart.localPart=email.slice(0,epart.lastAt);epart.domainAll=email.slice(epart.lastAt+1);epart.domainOnly=email.slice(epart.lastAt+1,epart.lastPoint);let numberTestTest=!1
let isLieT=!1
let grubo=!1
let stopAnonimayzerTest=!1
let yaphoneTest=!1
let tireStopTest=!1
let neNaTest=!1
let stopDomainALLTest=!1
let oneLetterTest=!1
let domainZoneLenghtTest=!1
let sintaksisValidTest=!1
let badZoneTest=!1
let minLengthTest=!1
numberTestTest=numberTest(epart.domainAll);if(numberTestTest){sendError(emailObj,'numberTestTest');return!1}
isLieT=isLie(email);if(isLieT){sendError(emailObj,'isLieTest');return!1}
grubo=validateEmail(email);if(!grubo){sendError(emailObj,'regulyarTest');return!1}
stopAnonimayzerTest=stopAnonimayzer(epart.domainAll);if(stopAnonimayzerTest){sendError(emailObj,'stopAnonimayzerTest');return!1}
sintaksisValidTest=sintaksisValid(epart);if(sintaksisValidTest){sendError(emailObj,'sintaksisValidTest');return!1}
epart.domainOnly=correctName(epart.domainOnly);domainZoneLenghtTest=domainZoneLenght(epart.domainZone);if(domainZoneLenghtTest){sendError(emailObj,'domainZoneLenght');return!1}
stopDomainALLTest=stopDomainALL(email);if(stopDomainALLTest){sendError(emailObj,'stopDomainALLTest');return!1}
oneLetterTest=oneLetter(epart.domainAll);if(oneLetterTest){sendError(emailObj,'oneLetterTest');return!1}
badZoneTest=badZone(epart.domainZone);if(badZoneTest){sendError(emailObj,'badZoneTest');return!1}
email=buildStandartEmail(email);if(yaphoneTest){sendError(emailObj,'yaphoneTest');return!1}
minLengthTest=minLength(epart);if(minLengthTest){sendError(emailObj,'minLengthTest');return!1}
tireStopTest=tireStop(epart.domainOnly,epart.localPart);if(tireStopTest){sendError(emailObj,'tireStopTest');return!1}
neNaTest=neNa(epart.domainAll);if(neNaTest){sendError(emailObj,'Not on '+neNaTest);return!1}
$('.testEmailButton').prop('disabled',!0);$('.testEmailButton').addClass('disbtn');$(emailObj).val(email);return email}
function sendError(emailObj,error){console.log(error);$('.'+error).show();$(emailObj).addClass('error');return!0}
function initialPreparation(email){if(email){email=email.trim().replace(/\s+/g,'').toLowerCase();if(email[0]=='+'){email=email.substr(1)}}
return email}
function clearPlus(email){let pos_plus=email.lastIndexOf('+');if(pos_plus>0){return email.substring(0,pos_plus)+email.substring(email.indexOf('@'))}
return email}
function numberTest(domainAll){return/\d/.test(domainAll)}
function isLie(email){let doman_email=email.split('@');if(doman_email[1]==window.location.host||'www.'+doman_email[1]==window.location.host){return!0}
let email_not_you=['mail@mail.ru','gmail@gmail.com','email@mail.ua','email@example.com'];for(let cx=0;cx<email_not_you.length;cx++){if(email_not_you[cx]==email){return!0}}
return!1}
function validateEmail(email){let re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)}
function tireStop(domainOnly,localPart){if((domainOnly.indexOf('yandex')!=-1)&&(localPart.indexOf('_')!=-1)){return!0}
return!1}
function neNa(domainAll){if(domainAll=='my.com'){return'my.com'}
if(domainAll=='rambler.ua'){return'rambler.ua'}
return!1}
function yaPhone(epart){if(epart.domainOnly.includes('yandex')||epart.domainOnly.includes('ya.ru')){const phoneCodes=[/^380/,/^37/,/^99/,/^79/,/^89/,/^371/,/^77/];if(phoneCodes.some(code=>code.test(epart.localPart))&&/^\d{11,13}$/.test(epart.localPart)){return!0}}
return!1}
function buildStandartEmail(email){let StandartEmail=email;if(/@(?:yandex\.[a-z]{2,3}|ya\.ru|narod\.ru)$/i.test(email)){const[box,domain]=email.split('@');StandartEmail=box.replace(/-/g,'.')+'@yandex.ru'}
if(/@(gmail\.com|googlemail\.com)$/i.test(email)){const[box,domain]=email.split('@');StandartEmail=box.replace(/\./g,'')+'@gmail.com'}
if(/@(pm\.me|proton\.me|protonmail\.com)$/i.test(email)){const[box,domain]=email.split('@');StandartEmail=box.replace(/\./g,'')+'@proton.me'}
if(/@(icloud\.com)$/i.test(email)){const[box,domain]=email.split('@');StandartEmail=box.replace(/\./g,'')+'@icloud.com'}
if(/@(ymail\.com)$/i.test(email)){const[box,domain]=email.split('@');StandartEmail=box+'@yahoo.com'}
return StandartEmail}
function stopAnonimayzer(domainAll){let anonimayzer=['scryptmail.com']
for(let cx=0;cx<anonimayzer.length;cx++){if(anonimayzer[cx]==domainAll){return!0}}
return!1}
function correctDomainZone(domainZone){const corrections={'ru':['ry','rv','ri','rn','tu','ty','my'],'com':['cjm','cpm','kom','gom','vom','con','kon','cm','om','cim','som','xom','cox'],'org':['orq','opq','opg'],'ua':['ya'],'net':['ner','het','bet','nen','nit','met','ney','ne','nwt']};for(let correctZone in corrections){if(corrections[correctZone].includes(domainZone)){return correctZone}}
return domainZone}
function correctName(domainOnly){const corrections={'yandex':['yandax','yandeks','yandx','yangex','jandex','yadex','uandex','yndex','ayndex'],'bigmir':['digmir','biqmir','diqmir'],'mail':['mfil','meil','msil','maij','maill','mil','imeil','mael','maii','mali','mal','majl','maul','masl','maik','ail','naul','nail'],'icloud':['icloud','cloud','ikloud','iclout','icloub','cloub'],'gmail':['gamailcom','gmaill','gmailco','gmel','qm','gmjl','gmm','gmaa','ggmai','cmal','cail','gail','gmal','gmei','gmaij','gmajl','qnail','gnail','gmeil','gmall','jmail','gmaii','gmali','hmail','gmael','jimal','jmeil','qhail','gmoil','ghail','cmail','gamil','dmail','gmaik','gmÐ¾il','gimajl','gimail','qemail','gomail','gemeil','gemail','gamail','gameil','gmaul','qeimal','glail','gmaile','goi','qoi','gmfql','gmd']};for(let correctName in corrections){if(corrections[correctName].includes(domainOnly)){return correctName}}
return domainOnly}
function stopDomainALL(email){let email_not_valid=['@com.ua','@ua.com','@kom.ua','@kis.ru','@kom.ru','@com.ru','@ru.com','@meil.com','@mael.com','@emeil.ru','@emeil.com','@imeil.ua','@com.com','@net.ua','@net.ru','@com.net','@example.com','@sitemail.com','@site.com','@email.com','@mailcom.ru','@yahoo.net','@hotmail.ru','@ramler.ru','@ramdler.ru','@rambler.com','@yaho.com','@ua.net','@ykr.net','@ykt.net','@ukt.net','@ucr.net','@ukr.com','@bigmir.ua','@bigmir.com','@gmail.ru','@gmail.ua','@gmail.com.ua','@gmail.com.ru','@ya.ua','@ya.com','@yande.ru','@yande.ua','@inboks.ru','@indox.ru','@list.ua','@list.com','@iist.ru','@iist.ua','@bk.com','@bk.ua','@dk.com','@br.com','@dk.ru','@br.ru','@bl.ru','@bj.ru','@vk.ru','@vk.com','@vkontakte.ru','@mail.com','@mail.com.ua','@mail.com.ru',];let from=email.search('@');let to=email.length;let new_email=email.substring(from,to);let domain_not_valid=['.yy','.aa'];for(let cx=0;cx<email_not_valid.length;cx++){if(email_not_valid[cx]==new_email){return!0}}
for(let cx=0;cx<domain_not_valid.length;cx++){from=to-domain_not_valid[cx].length;let email_domain=email.substring(from,to);if(email_domain==domain_not_valid[cx]){return!0}}
return!1}
function oneLetter(domainAll){if(domainAll!=undefined){if(domainAll.indexOf('i.ua')==-1&&domainAll.indexOf('a.ua')==-1){let split_email=domainAll.split('.');if(split_email[0].length==1)
return!0}}
return!1}
function domainZoneLenght(domainZone){if(domainZone.length>4){return!0}
return!1}
function badZone(domainZone){if(domainZone=='.xxx'||domainZone=='.biz'||domainZone=='.cc'){return!0}
return!1}
function minLength(epart){const domainRules={'i.ua':6,'ro.ru':6,'r0.ru':6,'rambler.ru':6,'lenta.ru':6,'myrambler.ru':6,'gmail.com':5,'mail.ru':3,'mail.ua':3,'inbox.ru':3,'list.ru':3,'bk.ru':3};const minLength=domainRules[epart.domainAll]!==undefined?domainRules[epart.domainAll]:3;return epart.localPart.length<minLength}
function sintaksisValid(epart){const restrictedDomains=['ya.ru','yandex','mail.ru','bk.ru','mail.ua','inbox.ru','gmail.com','list.ru'];const invalidPatterns=['..','-.','.-','_.','._','--','-_','_-','__'];if(restrictedDomains.some(domain=>epart.domainAll.includes(domain))&&invalidPatterns.some(pattern=>epart.domainAll.includes(pattern))){return!0}
if(epart.localPart[0]!=undefined){if(epart.localPart[0].indexOf('.')!=-1||epart.localPart[0].indexOf('-')!=-1||epart.localPart[0].indexOf('_')!=-1)
return!0;if(epart.localPart[epart.localPart.length-1].indexOf('.')!=-1||epart.localPart[epart.localPart.length-1].indexOf('-')!=-1||epart.localPart[epart.localPart.length-1].indexOf('_')!=-1)
return!0}
let email_array=epart.domainAll.split('.');if(email_array.length>3){return!0}
let ext=email_array[email_array.length-1];if(/\d/.test(ext)){return!0}
return!1}